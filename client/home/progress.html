<script type="module">
  import { watchProgress } from "../apiCalls.js";

  $(async () => {
    var accountContent = $(".account-content");
    try {
      const result = await watchProgress();
      var tableContent = $(`
        <div class="table-content" id="completed-table">
          <h1 class="table-title">
            Số đơn vị đã hoàn thành: ${result.completed}/${result.total}
          </h1>
          <div class="table-details">
            <table>
              <tr>
                <th>Mã đơn vị</th>
                <th>Tên đơn vị</th>
                <th>Trạng thái hoàn thành</th>
              </tr>
            </table>
          </div>
        </div>
      `);

      accountContent.append(tableContent);

      for (const unit of result.details) {
        console.log($("completed-table table"));
        $("#completed-table table").append(`
          <tr>
            <td>${unit.ma}</td>
            <td>${unit.ten}</td>
            <td>
              ${unit.hoan_thanh ? "Đã hoàn thành" : "Chưa hoàn thành"}
            </td> 
          </tr>
        `);
      }
    } catch (err) {
      progressList.replaceWith("<p>Đã có lỗi xảy ra. Vui lòng thử lại.</p>");
    }
  });
</script>
